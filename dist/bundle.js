!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var n,o=function(){function t(t,e){this.x=t,this.y=e,this.nextField=void 0}return t.prototype.detectCollision=function(t){return this.x===t.x&&this.y===t.y},t}();!function(t){t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT"}(n||(n={}));var r,s=function(){function t(){}return t.GAME_WIDTH=20,t.GAME_HEIGHT=20,t.FIELD_SIZE=20,t}(),h=function(){function t(t){this.head=new o(2,7),this.tail=[],this.size=0,this.game=t}return t.prototype.draw=function(t){t.fillStyle="red",this.drawField(this.head,t,s.FIELD_SIZE);for(var e=0;e<this.tail.length;e++)this.drawField(this.tail[e],t,s.FIELD_SIZE)},t.prototype.changeDirection=function(t){t===n.LEFT&&this.direction===n.RIGHT||t===n.UP&&this.direction===n.DOWN||t===n.DOWN&&this.direction===n.UP||t===n.RIGHT&&this.direction===n.LEFT||(this.direction=t)},t.prototype.move=function(){void 0!==this.direction&&(this.tail.push(this.head),this.head=this.getNext(),this.head.detectCollision(this.game.food)&&(this.size++,this.game.snakeFoundFood()),this.tail.length>this.size&&this.tail.splice(0,1))},t.prototype.fieldsAreEmpty=function(t){var e=!1;this.head.detectCollision(t)&&(e=!0);for(var i=0;i<this.tail.length;i++)this.tail[i].detectCollision(t)&&(e=!0);return e},t.prototype.snakeSlidesIntoItself=function(){for(var t=0;t<this.tail.length;t++)if(this.head.detectCollision(this.tail[t]))return!0;return!1},t.prototype.getNext=function(){switch(this.direction){case n.UP:return this.head.y-1<1?new o(this.head.x,s.GAME_HEIGHT):new o(this.head.x,this.head.y-1);case n.RIGHT:return this.head.x+1>s.GAME_WIDTH?new o(1,this.head.y):new o(this.head.x+1,this.head.y);case n.DOWN:return this.head.y===s.GAME_HEIGHT?new o(this.head.x,1):new o(this.head.x,this.head.y+1);case n.LEFT:return this.head.x-1==0?new o(s.GAME_WIDTH,this.head.y):new o(this.head.x-1,this.head.y)}},t.prototype.drawField=function(t,e,i){e.fillRect((t.x-1)*i,(t.y-1)*i,i,i)},t}(),a=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.draw=function(t){t.fillStyle="green",t.fillRect((this.x-1)*s.FIELD_SIZE,(this.y-1)*s.FIELD_SIZE,s.FIELD_SIZE,s.FIELD_SIZE)},e}(o);i.d(e,"SnakeGame",function(){return d});var d=function(){function t(){var t=this,e=document.getElementById("snake");this.ctx=e.getContext("2d"),this.startNewGame(),setInterval(function(){t.nextStep()},100),this.keyboardInput()}return t.prototype.nextStep=function(){this.snake.move(),this.draw()},t.prototype.gameOver=function(){},t.prototype.snakeFoundFood=function(){this.placeNewFood(),this.increaseScore()},t.prototype.startNewGame=function(){this.snake=new h(this),this.food=new c(4,4),this.draw(),this.score=0},t.prototype.placeNewFood=function(){for(var t=Math.floor(Math.random()*(s.GAME_WIDTH-1+1))+1,e=Math.floor(Math.random()*(s.GAME_HEIGHT-1+1))+1,i=new c(t,e);this.snake.fieldsAreEmpty(i);)t=Math.floor(Math.random()*(s.GAME_WIDTH-1+1))+1,e=Math.floor(Math.random()*(s.GAME_HEIGHT-1+1))+1,i=new c(t,e);this.food=i},t.prototype.increaseScore=function(){this.score++},t.prototype.draw=function(){this.ctx.fillStyle="grey",this.ctx.fillRect(0,0,s.GAME_WIDTH*s.FIELD_SIZE,s.GAME_HEIGHT*s.FIELD_SIZE),this.food.draw(this.ctx),this.snake.draw(this.ctx)},t.prototype.keyboardInput=function(){var t=this;document.addEventListener("keydown",function(e){37===e.keyCode?t.snake.changeDirection(n.LEFT):38===e.keyCode?t.snake.changeDirection(n.UP):39===e.keyCode?t.snake.changeDirection(n.RIGHT):40===e.keyCode&&t.snake.changeDirection(n.DOWN)})},t}();new d}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZpZWxkLnRzIiwid2VicGFjazovLy8uL3NyYy9kaXJlY3Rpb24udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50LnRzIiwid2VicGFjazovLy8uL3NyYy9zbmFrZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZm9vZC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvc25ha2VfZ2FtZS50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiRGlyZWN0aW9uIiwiRmllbGQiLCJ4IiwieSIsInRoaXMiLCJuZXh0RmllbGQiLCJ1bmRlZmluZWQiLCJkZXRlY3RDb2xsaXNpb24iLCJmaWVsZCIsIkNvbnN0YW50IiwiR0FNRV9XSURUSCIsIkdBTUVfSEVJR0hUIiwiRklFTERfU0laRSIsInNuYWtlX1NuYWtlIiwiU25ha2UiLCJnYW1lIiwiaGVhZCIsInRhaWwiLCJzaXplIiwiZHJhdyIsImN0eCIsImZpbGxTdHlsZSIsImRyYXdGaWVsZCIsImxlbmd0aCIsImNoYW5nZURpcmVjdGlvbiIsImRpcmVjdGlvbiIsIkxFRlQiLCJSSUdIVCIsIlVQIiwiRE9XTiIsIm1vdmUiLCJwdXNoIiwiZ2V0TmV4dCIsImZvb2QiLCJzbmFrZUZvdW5kRm9vZCIsInNwbGljZSIsImZpZWxkc0FyZUVtcHR5IiwiY29sbGlzaW9uIiwic25ha2VTbGlkZXNJbnRvSXRzZWxmIiwic25ha2VQYXJ0IiwiZmlsbFJlY3QiLCJmb29kX0Zvb2QiLCJfc3VwZXIiLCJGb29kIiwiX19leHRlbmRzIiwic25ha2VfZ2FtZV9TbmFrZUdhbWUiLCJTbmFrZUdhbWUiLCJfdGhpcyIsImNhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwic3RhcnROZXdHYW1lIiwic2V0SW50ZXJ2YWwiLCJuZXh0U3RlcCIsImtleWJvYXJkSW5wdXQiLCJzbmFrZSIsImdhbWVPdmVyIiwicGxhY2VOZXdGb29kIiwiaW5jcmVhc2VTY29yZSIsInNjb3JlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Q29kZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBakIsR0FDQVksT0FBQUMsZUFBQWIsRUFBQSxjQUFpRGtCLE9BQUEsS0FJakRwQixFQUFBcUIsRUFBQSxTQUFBbEIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBbUIsV0FDQSxXQUEyQixPQUFBbkIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElB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RUFBU0MsV0FBYUQsRUFBU0csV0FBWUgsRUFBU0UsWUFBY0YsRUFBU0csWUFDbkdSLEtBQUs2QixLQUFLZCxLQUFLZixLQUFLZ0IsS0FDcEJoQixLQUFLb0QsTUFBTXJDLEtBQUtmLEtBQUtnQixNQUdqQjBCLEVBQUFsRCxVQUFBMkQsY0FBUixlQUFBUixFQUFBM0MsS0FDSTZDLFNBQVNlLGlCQUFpQixVQUFXLFNBQUNDLEdBQ1osS0FBbEJBLEVBQU1DLFFBQ1ZuQixFQUFLUyxNQUFNaEMsZ0JBQWdCeEIsRUFBVTBCLE1BQ1IsS0FBbEJ1QyxFQUFNQyxRQUNibkIsRUFBS1MsTUFBTWhDLGdCQUFnQnhCLEVBQVU0QixJQUNaLEtBQWxCcUMsRUFBTUMsUUFDYm5CLEVBQUtTLE1BQU1oQyxnQkFBZ0J4QixFQUFVMkIsT0FDWixLQUFsQnNDLEVBQU1DLFNBQ2JuQixFQUFLUyxNQUFNaEMsZ0JBQWdCeEIsRUFBVTZCLFNBSXJEaUIsRUE3RUEsR0ErRXVCLElBQUlEIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgY2xhc3MgRmllbGQge1xyXG4gICAgcHVibGljIG5leHRGaWVsZCA6IEZpZWxkO1xyXG4gICAgcHVibGljIHggOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgeSA6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih4IDogbnVtYmVyLCB5IDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgIHRoaXMubmV4dEZpZWxkID0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBkZXRlY3RDb2xsaXNpb24oZmllbGQ6IEZpZWxkKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnggPT09IGZpZWxkLnggJiYgdGhpcy55ID09PSBmaWVsZC55KTtcclxuICAgIH1cclxufSIsImV4cG9ydCBlbnVtIERpcmVjdGlvbiB7XHJcbiAgICBVUCxcclxuICAgIFJJR0hULFxyXG4gICAgRE9XTixcclxuICAgIExFRlRcclxufSIsImV4cG9ydCBjbGFzcyBDb25zdGFudCB7XHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgR0FNRV9XSURUSCA6IG51bWJlciA9IDIwO1xyXG4gICAgc3RhdGljIHJlYWRvbmx5IEdBTUVfSEVJR0hUIDogbnVtYmVyID0gMjA7XHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgRklFTERfU0laRSA6IG51bWJlciA9IDIwO1xyXG59IiwiaW1wb3J0IHsgRmllbGQgfSBmcm9tIFwiLi9maWVsZFwiO1xyXG5pbXBvcnQgeyBEaXJlY3Rpb24gfSBmcm9tIFwiLi9kaXJlY3Rpb25cIjtcclxuaW1wb3J0IHsgU25ha2VHYW1lIH0gZnJvbSBcIi4vc25ha2VfZ2FtZVwiO1xyXG5pbXBvcnQgeyBDb25zdGFudCB9IGZyb20gXCIuL2NvbnN0YW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU25ha2Uge1xyXG4gICAgcHJpdmF0ZSBnYW1lIDogU25ha2VHYW1lO1xyXG4gICAgcHJpdmF0ZSBoZWFkIDogRmllbGQ7XHJcbiAgICBwcml2YXRlIHRhaWwgOiBGaWVsZFtdO1xyXG4gICAgcHJpdmF0ZSBzaXplIDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBkaXJlY3Rpb246IERpcmVjdGlvbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lOiBTbmFrZUdhbWUpIHtcclxuICAgICAgICB0aGlzLmhlYWQgPSBuZXcgRmllbGQoMiwgNyk7XHJcbiAgICAgICAgdGhpcy50YWlsID0gW107XHJcbiAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgICAgICB0aGlzLmdhbWUgPSBnYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBkcmF3KGN0eCA6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcInJlZFwiO1xyXG4gICAgICAgIHRoaXMuZHJhd0ZpZWxkKHRoaXMuaGVhZCwgY3R4LCBDb25zdGFudC5GSUVMRF9TSVpFKTtcclxuICAgICAgICBmb3IodmFyIGk6IG51bWJlciA9IDA7IGkgPCB0aGlzLnRhaWwubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5kcmF3RmllbGQodGhpcy50YWlsW2ldLCBjdHgsIENvbnN0YW50LkZJRUxEX1NJWkUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2hhbmdlRGlyZWN0aW9uKGRpcmVjdGlvbjogRGlyZWN0aW9uKTogdm9pZCB7XHJcbiAgICAgICAgaWYoZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uTEVGVCAmJiB0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLlJJR0hUKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLlVQICYmIHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRE9XTikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09IERpcmVjdGlvbi5ET1dOICYmIHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uVVApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uUklHSFQgJiYgdGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5MRUZUKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG1vdmUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYodGhpcy5kaXJlY3Rpb24gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFkZCBjdXJyZW50IGhlYWQgdG8gdGFpbFxyXG4gICAgICAgIHRoaXMudGFpbC5wdXNoKHRoaXMuaGVhZCk7XHJcblxyXG4gICAgICAgIC8vIGdldCBuZXh0IHBvc2l0aW9uXHJcbiAgICAgICAgdGhpcy5oZWFkID0gdGhpcy5nZXROZXh0KCk7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuaGVhZC5kZXRlY3RDb2xsaXNpb24odGhpcy5nYW1lLmZvb2QpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZSsrO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuc25ha2VGb3VuZEZvb2QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGZpeCB0aGUgd29ybSBzaXplXHJcbiAgICAgICAgaWYgKHRoaXMudGFpbC5sZW5ndGggPiB0aGlzLnNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy50YWlsLnNwbGljZSgwLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGZpZWxkc0FyZUVtcHR5KGZpZWxkOiBGaWVsZCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHZhciBjb2xsaXNpb24gOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuaGVhZC5kZXRlY3RDb2xsaXNpb24oZmllbGQpKSB7XHJcbiAgICAgICAgICAgIGNvbGxpc2lvbiA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IodmFyIGk6IG51bWJlciA9IDA7IGkgPCB0aGlzLnRhaWwubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYodGhpcy50YWlsW2ldLmRldGVjdENvbGxpc2lvbihmaWVsZCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbGxpc2lvbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjb2xsaXNpb247XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgc25ha2VTbGlkZXNJbnRvSXRzZWxmKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGZvcih2YXIgaTogbnVtYmVyID0gMDsgaSA8IHRoaXMudGFpbC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZih0aGlzLmhlYWQuZGV0ZWN0Q29sbGlzaW9uKHRoaXMudGFpbFtpXSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXROZXh0KCk6IEZpZWxkIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgRGlyZWN0aW9uLlVQOlxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5oZWFkLnkgLSAxIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5oZWFkLngsIENvbnN0YW50LkdBTUVfSEVJR0hUKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZCh0aGlzLmhlYWQueCwgdGhpcy5oZWFkLnkgLSAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBEaXJlY3Rpb24uUklHSFQ6XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmhlYWQueCArIDEgPiBDb25zdGFudC5HQU1FX1dJRFRIKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZCgxLCB0aGlzLmhlYWQueSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5oZWFkLnggKyAxLCB0aGlzLmhlYWQueSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgRGlyZWN0aW9uLkRPV046XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmhlYWQueSA9PT0gQ29uc3RhbnQuR0FNRV9IRUlHSFQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkKHRoaXMuaGVhZC54LCAxKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZCh0aGlzLmhlYWQueCwgdGhpcy5oZWFkLnkgKyAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBEaXJlY3Rpb24uTEVGVDpcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuaGVhZC54IC0gMSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGQoQ29uc3RhbnQuR0FNRV9XSURUSCwgdGhpcy5oZWFkLnkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkKHRoaXMuaGVhZC54LTEsIHRoaXMuaGVhZC55KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkcmF3RmllbGQoc25ha2VQYXJ0OiBGaWVsZCwgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHNpemU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGN0eC5maWxsUmVjdCgoc25ha2VQYXJ0LnggLSAxKSAqIHNpemUsIChzbmFrZVBhcnQueSAtIDEpICogc2l6ZSwgc2l6ZSwgc2l6ZSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBGaWVsZCB9IGZyb20gXCIuL2ZpZWxkXCI7XHJcbmltcG9ydCB7IENvbnN0YW50IH0gZnJvbSBcIi4vY29uc3RhbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBGb29kIGV4dGVuZHMgRmllbGQge1xyXG4gICAgcHVibGljIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOnZvaWQge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcImdyZWVuXCI7XHJcbiAgICAgICAgY3R4LmZpbGxSZWN0KCh0aGlzLnggLSAxKSAqIENvbnN0YW50LkZJRUxEX1NJWkUsICh0aGlzLnkgLSAxKSAqIENvbnN0YW50LkZJRUxEX1NJWkUsQ29uc3RhbnQuRklFTERfU0laRSwgQ29uc3RhbnQuRklFTERfU0laRSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBTbmFrZSB9IGZyb20gXCIuL3NuYWtlXCI7XHJcbmltcG9ydCB7IEZvb2QgfSBmcm9tIFwiLi9mb29kXCI7XHJcbmltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gXCIuL2RpcmVjdGlvblwiO1xyXG5pbXBvcnQgeyBDb25zdGFudCB9IGZyb20gXCIuL2NvbnN0YW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU25ha2VHYW1lIHtcclxuICAgIHB1YmxpYyBmb29kIDogRm9vZDtcclxuICAgIHByaXZhdGUgc25ha2UgOiBTbmFrZTtcclxuICAgIHByaXZhdGUgY3R4IDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4gICAgcHJpdmF0ZSBzY29yZSA6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB2YXIgY2FudmFzIDogSFRNTENhbnZhc0VsZW1lbnQgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic25ha2VcIik7XHJcbiAgICAgICAgdGhpcy5jdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXJ0TmV3R2FtZSgpO1xyXG5cclxuICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dFN0ZXAoKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIHRoaXMua2V5Ym9hcmRJbnB1dCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZXh0U3RlcCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNuYWtlLm1vdmUoKTtcclxuICAgICAgICB0aGlzLmRyYXcoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2FtZU92ZXIoKTogdm9pZCB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzbmFrZUZvdW5kRm9vZCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBsYWNlTmV3Rm9vZCgpO1xyXG4gICAgICAgIHRoaXMuaW5jcmVhc2VTY29yZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGFydE5ld0dhbWUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zbmFrZSA9IG5ldyBTbmFrZSh0aGlzKTtcclxuICAgICAgICB0aGlzLmZvb2QgPSBuZXcgRm9vZCg0LCA0KTtcclxuICAgICAgICB0aGlzLmRyYXcoKTtcclxuICAgICAgICB0aGlzLnNjb3JlID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHBsYWNlTmV3Rm9vZCgpOiB2b2lkIHtcclxuICAgICAgICB2YXIgeCA6IG51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChDb25zdGFudC5HQU1FX1dJRFRIIC0gMSArIDEpKSArIDE7XHJcbiAgICAgICAgdmFyIHkgOiBudW1iZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoQ29uc3RhbnQuR0FNRV9IRUlHSFQgLSAxICsgMSkpICsgMTtcclxuICAgICAgICB2YXIgZm9vZCA6IEZvb2QgPSBuZXcgRm9vZCh4LCB5KTtcclxuXHJcbiAgICAgICAgd2hpbGUodGhpcy5zbmFrZS5maWVsZHNBcmVFbXB0eShmb29kKSkge1xyXG4gICAgICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKENvbnN0YW50LkdBTUVfV0lEVEggLSAxICsgMSkpICsgMTtcclxuICAgICAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChDb25zdGFudC5HQU1FX0hFSUdIVCAtIDEgKyAxKSkgKyAxO1xyXG4gICAgICAgICAgICBmb29kID0gbmV3IEZvb2QoeCwgeSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmZvb2QgPSBmb29kO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5jcmVhc2VTY29yZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNjb3JlKys7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkcmF3KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IFwiZ3JleVwiO1xyXG4gICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KDAsIDAsIENvbnN0YW50LkdBTUVfV0lEVEggKiBDb25zdGFudC5GSUVMRF9TSVpFLCBDb25zdGFudC5HQU1FX0hFSUdIVCAqIENvbnN0YW50LkZJRUxEX1NJWkUpO1xyXG4gICAgICAgIHRoaXMuZm9vZC5kcmF3KHRoaXMuY3R4KTtcclxuICAgICAgICB0aGlzLnNuYWtlLmRyYXcodGhpcy5jdHgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUga2V5Ym9hcmRJbnB1dCgpOiB2b2lkIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM3KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc25ha2UuY2hhbmdlRGlyZWN0aW9uKERpcmVjdGlvbi5MRUZUKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAzOCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zbmFrZS5jaGFuZ2VEaXJlY3Rpb24oRGlyZWN0aW9uLlVQKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAzOSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zbmFrZS5jaGFuZ2VEaXJlY3Rpb24oRGlyZWN0aW9uLlJJR0hUKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSA0MCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zbmFrZS5jaGFuZ2VEaXJlY3Rpb24oRGlyZWN0aW9uLkRPV04pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbnZhciBHYW1lIDogU25ha2VHYW1lID0gbmV3IFNuYWtlR2FtZSgpO1xyXG5cclxuXHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9